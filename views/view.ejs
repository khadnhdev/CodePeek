<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Render</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h1>Rendered Result</h1>
        <div class="row">
            <div class="col-md-6">
                <h3>Input:</h3>
                <pre><code><%= render.input_code %></code></pre>
            </div>
            <div class="col-md-6">
                <h3>Output:</h3>
                <div id="output" class="border p-3"></div>
            </div>
        </div>
        <a href="/" class="btn btn-primary mt-3">Back to Home</a>
    </div>

    <script>
        mermaid.initialize({ startOnLoad: true });
        
        window.onload = function() {
            const code = `<%= render.input_code %>`;
            const type = '<%= render.type %>';
            const output = document.getElementById('output');

            if (type === 'mermaid') {
                // Render Mermaid diagram
                output.innerHTML = `<div class="mermaid">${code}</div>`;
                mermaid.init();
            } else {
                // Render combined HTML/CSS/JS
                const iframe = document.createElement('iframe');
                iframe.style.width = '100%';
                iframe.style.height = '400px';
                iframe.style.border = 'none';
                output.appendChild(iframe);

                const iframeDoc = iframe.contentWindow.document;
                iframeDoc.open();
                iframeDoc.write(code);
                iframeDoc.close();
            }
        };
    </script>
</body>
</html> 